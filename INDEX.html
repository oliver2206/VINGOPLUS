<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bingo Card Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .bingo-cell {
            transition: all 0.2s ease;
        }
        
        .bingo-cell:hover {
            transform: scale(1.05);
        }
        
        .bingo-cell.called {
            background-color: #3B82F6;
            color: white;
        }
        
        .card-container {
            perspective: 1000px;
        }
        
        .bingo-card {
            transition: transform 0.5s;
        }
        
        .bingo-card:hover {
            transform: rotateY(5deg);
        }
        
        .drag-area {
            transition: all 0.3s ease;
        }
        
        .drag-area.active {
            border-color: #3B82F6;
            background-color: #EFF6FF;
        }
        
        .uploaded-image {
            max-width: 100%;
            max-height: 150px;
            border-radius: 8px;
            object-fit: contain;
        }
        
        .analysis-animation {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% {
                opacity: 0.6;
            }
            50% {
                opacity: 1;
            }
            100% {
                opacity: 0.6;
            }
        }
        
        .number-badge {
            transition: all 0.3s ease;
        }
        
        .number-badge:hover {
            transform: scale(1.1);
        }
        
        @media print {
            .no-print {
                display: none !important;
            }
            .bingo-card {
                break-inside: avoid;
                margin-bottom: 20px;
            }
        }
    </style>
</head>

<body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen font-sans">
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-blue-800 mb-2">Bingo Card Generator</h1>
            <p class="text-lg text-blue-600">Create up to 5 bingo cards using Bingo Plus results</p>
        </header>

        <main class="max-w-6xl mx-auto">
            <div class="grid md:grid-cols-2 gap-8 mb-12">
                <!-- Upload Section -->
                <div class="bg-white rounded-xl shadow-lg p-6 no-print">
                    <h2 class="text-2xl font-bold text-blue-800 mb-4">Upload Screenshots</h2>
                    <p class="text-gray-600 mb-6">Upload your Bingo Plus screenshots.</p>

                    <div class="drag-area border-2 border-dashed border-blue-300 rounded-lg p-6 text-center mb-6 bg-blue-50" id="drag-area">
                        <i class="fas fa-cloud-upload-alt text-blue-500 text-4xl mb-3"></i>
                        <p class="text-blue-700 font-medium mb-2">Drag & Drop your screenshots here</p>
                        <p class="text-blue-500 text-sm">or</p>
                        <label for="file-upload" class="mt-3 cursor-pointer inline-block bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors">
              <i class="fas fa-file-image mr-2"></i>Browse Files
            </label>
                        <input id="file-upload" type="file" accept="image/*" class="hidden" multiple>
                    </div>

                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-blue-800 mb-3">Uploaded Screenshots</h3>
                        <div class="grid grid-cols-3 gap-3" id="uploaded-images"></div>
                    </div>

                    <button class="w-full bg-indigo-600 hover:bg-indigo-700 text-white py-3 rounded-lg font-semibold flex items-center justify-center mb-6" id="analyze-btn">
            <i class="fas fa-search mr-2"></i> Analyze Screenshots for Numbers
          </button>
                </div>

                <!-- Card Configuration -->
                <div class="bg-white rounded-xl shadow-lg p-6 no-print">
                    <h2 class="text-2xl font-bold text-blue-800 mb-4">Card Configuration</h2>

                    <div class="mb-6">
                        <label class="block text-blue-800 font-medium mb-2">Number of Cards (Max 5)</label>
                        <div class="flex items-center">
                            <button class="bg-blue-200 text-blue-800 w-10 h-10 rounded-l-lg" id="decrease-cards"><i class="fas fa-minus"></i></button>
                            <input type="number" min="1" max="5" value="3" class="w-16 h-10 text-center border-t border-b border-blue-200" id="card-count">
                            <button class="bg-blue-200 text-blue-800 w-10 h-10 rounded-r-lg" id="increase-cards"><i class="fas fa-plus"></i></button>
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="flex items-center">
              <input type="checkbox" class="rounded text-blue-600 mr-2" id="include-free-space" checked>
              <span class="text-blue-800">Include free space in center</span>
            </label>
                    </div>

                    <button class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-semibold flex items-center justify-center" id="generate-btn">
            <i class="fas fa-magic mr-2"></i> Generate Bingo Cards
          </button>
                </div>
            </div>

            <!-- Generated Cards Section -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex justify-between items-center mb-6 no-print">
                    <h2 class="text-2xl font-bold text-blue-800">Generated Bingo Cards</h2>
                    <div class="flex space-x-2">
                        <button class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg flex items-center" id="download-btn">
              <i class="fas fa-download mr-2"></i> Download All
            </button>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg flex items-center" id="print-btn">
              <i class="fas fa-print mr-2"></i> Print Cards
            </button>
                    </div>
                </div>

                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="cards-container"></div>
            </div>
        </main>

        <footer class="mt-12 text-center text-blue-600 no-print">
            <p>Â© 2023 Bingo Card Generator | Created for Bingo Plus players</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const CARDS_LIMIT = 5;
            const cardCountInput = document.getElementById('card-count');
            const decreaseBtn = document.getElementById('decrease-cards');
            const increaseBtn = document.getElementById('increase-cards');
            const generateBtn = document.getElementById('generate-btn');
            const printBtn = document.getElementById('print-btn');
            const downloadBtn = document.getElementById('download-btn');
            const cardsContainer = document.getElementById('cards-container');
            const dragArea = document.getElementById('drag-area');
            const fileUpload = document.getElementById('file-upload');
            const uploadedImagesContainer = document.getElementById('uploaded-images');
            const analyzeBtn = document.getElementById('analyze-btn');

            let calledNumbers = [];
            let uploadedFiles = [];

            const COL_KEYS = ['B', 'I', 'N', 'G', 'O'];
            const COL_RANGES = {
                B: [1, 15],
                I: [16, 30],
                N: [31, 45],
                G: [46, 60],
                O: [61, 75]
            };

            // Card count controls
            decreaseBtn.addEventListener('click', () => {
                if (cardCountInput.value > 1) cardCountInput.value--;
            });
            increaseBtn.addEventListener('click', () => {
                if (cardCountInput.value < CARDS_LIMIT) cardCountInput.value++;
            });

            generateBtn.addEventListener('click', generateCards);
            printBtn.addEventListener('click', () => window.print());
            downloadBtn.addEventListener('click', () => alert('Download as PDF not yet implemented'));
            analyzeBtn.addEventListener('click', analyzeScreenshots);

            // Drag & drop upload
            dragArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                dragArea.classList.add('active');
            });
            dragArea.addEventListener('dragleave', () => dragArea.classList.remove('active'));
            dragArea.addEventListener('drop', (e) => {
                e.preventDefault();
                dragArea.classList.remove('active');
                handleFiles(e.dataTransfer.files);
            });
            fileUpload.addEventListener('change', (e) => handleFiles(e.target.files));

            function handleFiles(files) {
                for (let i = 0; i < files.length; i++) {
                    if (files[i].type.startsWith('image/')) {
                        uploadedFiles.push(files[i]);
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const imgDiv = document.createElement('div');
                            imgDiv.className = 'relative';
                            const img = document.createElement('img');
                            img.src = e.target.result;
                            img.className = 'uploaded-image border border-gray-200';
                            const removeBtn = document.createElement('button');
                            removeBtn.className = 'absolute top-0 right-0 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs';
                            removeBtn.innerHTML = '&times;';
                            removeBtn.onclick = () => {
                                imgDiv.remove();
                                uploadedFiles = uploadedFiles.filter(f => f !== files[i]);
                            };
                            imgDiv.appendChild(img);
                            imgDiv.appendChild(removeBtn);
                            uploadedImagesContainer.appendChild(imgDiv);
                        };
                        reader.readAsDataURL(files[i]);
                    }
                }
            }

            // Fake OCR analysis -> just create random numbers
            function analyzeScreenshots() {
                if (uploadedFiles.length === 0) {
                    alert('Please upload at least one screenshot first!');
                    return;
                }
                analyzeBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Analyzing...';
                analyzeBtn.classList.add('analysis-animation');

                setTimeout(() => {
                    let allNumbers = [];
                    uploadedFiles.forEach(() => {
                        while (allNumbers.length < 20) {
                            let num = Math.floor(Math.random() * 75) + 1;
                            if (!allNumbers.includes(num)) allNumbers.push(num);
                        }
                    });

                    calledNumbers = allNumbers;
                    generateCards();

                    analyzeBtn.innerHTML = '<i class="fas fa-search mr-2"></i> Analyze Screenshots for Numbers';
                    analyzeBtn.classList.remove('analysis-animation');
                    alert(`Analyzed ${uploadedFiles.length} screenshot(s). Found ${calledNumbers.length} numbers!`);
                }, 2000);
            }

            function groupNumbersByColumn(numbers) {
                let layout = {
                    B: [],
                    I: [],
                    N: [],
                    G: [],
                    O: []
                };
                numbers.forEach(num => {
                    if (num >= 1 && num <= 15) layout.B.push(num);
                    else if (num >= 16 && num <= 30) layout.I.push(num);
                    else if (num >= 31 && num <= 45) layout.N.push(num);
                    else if (num >= 46 && num <= 60) layout.G.push(num);
                    else if (num >= 61 && num <= 75) layout.O.push(num);
                });
                for (let key of COL_KEYS) {
                    const [min, max] = COL_RANGES[key];
                    while (layout[key].length < 5) {
                        let n = Math.floor(Math.random() * (max - min + 1)) + min;
                        if (!layout[key].includes(n)) layout[key].push(n);
                    }
                    layout[key] = shuffleArray(layout[key]).slice(0, 5);
                }
                return layout;
            }

            function shuffleArray(arr) {
                let copy = [...arr];
                for (let i = copy.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [copy[i], copy[j]] = [copy[j], copy[i]];
                }
                return copy;
            }

            function generateCards() {
                const cardCount = parseInt(cardCountInput.value);
                const includeFreeSpace = document.getElementById('include-free-space').checked;
                cardsContainer.innerHTML = '';

                if (!calledNumbers || calledNumbers.length === 0) {
                    calledNumbers = Array.from({
                        length: 75
                    }, (_, i) => i + 1);
                }

                for (let i = 1; i <= cardCount; i++) {
                    const columnPools = groupNumbersByColumn(calledNumbers);

                    const cardDiv = document.createElement('div');
                    cardDiv.className = 'border-2 border-blue-300 rounded-xl p-4 bg-blue-50 card-container';

                    const cardTitle = document.createElement('h3');
                    cardTitle.className = 'text-center font-bold text-blue-800 mb-2';
                    cardTitle.textContent = `Card #${i}`;

                    const cardGrid = document.createElement('div');
                    cardGrid.className = 'grid grid-cols-5 gap-1 mx-auto max-w-xs bingo-card';

                    COL_KEYS.forEach(l => {
                        const h = document.createElement('div');
                        h.className = 'bg-blue-100 text-blue-800 font-bold rounded-lg p-2 text-center h-12 flex items-center justify-center';
                        h.textContent = l;
                        cardGrid.appendChild(h);
                    });

                    for (let row = 0; row < 5; row++) {
                        for (let col = 0; col < 5; col++) {
                            const colKey = COL_KEYS[col];
                            let num = columnPools[colKey][row];
                            const cell = document.createElement('div');
                            cell.className = 'bg-white rounded-lg p-2 text-center h-12 flex items-center justify-center bingo-cell';

                            if (includeFreeSpace && row === 2 && col === 2) {
                                cell.innerHTML = '<i class="fas fa-star text-blue-600"></i>';
                                cell.classList.add('bg-blue-200');
                            } else {
                                cell.textContent = num;
                                if (calledNumbers.includes(num)) {
                                    cell.classList.add('called');
                                }
                            }
                            cell.addEventListener('click', () => cell.classList.toggle('called'));
                            cardGrid.appendChild(cell);
                        }
                    }

                    cardDiv.appendChild(cardTitle);
                    cardDiv.appendChild(cardGrid);
                    cardsContainer.appendChild(cardDiv);
                }
            }
        });
    </script>
</body>

</html>