<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bingo Card Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* All previous CSS styles remain the same */
        .bingo-cell {
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .bingo-cell:hover {
            transform: scale(1.05);
        }
        
        .bingo-cell.called {
            background-color: #3B82F6;
            color: white;
        }
        
        .bingo-cell.marked {
            background-color: white !important;
            color: black !important;
            border: 2px solid #3B82F6;
        }
        
        .bingo-cell.editing {
            border: 2px dashed #EF4444;
            background-color: #FEF3C7;
        }
        
        .number-b {
            background-color: #3B82F6 !important;
            color: white !important;
        }
        
        .number-i {
            background-color: #EF4444 !important;
            color: white !important;
        }
        
        .number-n {
            background-color: #6B7280 !important;
            color: white !important;
        }
        
        .number-g {
            background-color: #10B981 !important;
            color: white !important;
        }
        
        .number-o {
            background-color: #F59E0B !important;
            color: white !important;
        }
        
        .lucky-badge-b {
            background-color: #3B82F6 !important;
            color: white !important;
        }
        
        .lucky-badge-i {
            background-color: #EF4444 !important;
            color: white !important;
        }
        
        .lucky-badge-n {
            background-color: #6B7280 !important;
            color: white !important;
        }
        
        .lucky-badge-g {
            background-color: #10B981 !important;
            color: white !important;
        }
        
        .lucky-badge-o {
            background-color: #F59E0B !important;
            color: white !important;
        }
        
        .card-container {
            perspective: 1000px;
        }
        
        .bingo-card {
            transition: transform 0.5s;
        }
        
        .bingo-card:hover {
            transform: rotateY(5deg);
        }
        
        .drag-area {
            transition: all 0.3s ease;
        }
        
        .drag-area.active {
            border-color: #3B82F6;
            background-color: #EFF6FF;
        }
        
        .uploaded-image {
            max-width: 100%;
            max-height: 150px;
            border-radius: 8px;
            object-fit: contain;
        }
        
        .analysis-animation {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% {
                opacity: 0.6;
            }
            50% {
                opacity: 1;
            }
            100% {
                opacity: 0.6;
            }
        }
        
        .number-badge {
            transition: all 0.3s ease;
        }
        
        .number-badge:hover {
            transform: scale(1.1);
        }
        
        .pattern-x {
            background-color: #EF4444 !important;
            color: white !important;
        }
        
        .pattern-four-corners {
            background-color: #10B981 !important;
            color: white !important;
        }
        
        .pattern-blackout {
            background-color: #ff0000 !important;
            color: white !important;
        }
        
        .pattern-line {
            background-color: #F59E0B !important;
            color: white !important;
        }
        
        .pattern-hallow {
            background-color: #8B5CF6 !important;
            color: white !important;
        }
        
        .pattern-selection {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .pattern-selection:hover {
            transform: scale(1.05);
        }
        
        .pattern-selection.selected {
            border-color: #3B82F6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
        }
        
        .pattern-preview {
            width: 100px;
            height: 100px;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 2px;
            margin: 0 auto;
        }
        
        .pattern-cell {
            background-color: #E5E7EB;
            border-radius: 4px;
        }
        
        .pattern-cell.active {
            background-color: #3B82F6;
        }
        
        .lucky-chart-tab {
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.75rem;
            padding: 0.5rem 0.25rem;
        }
        
        .lucky-chart-tab.active {
            background-color: #3B82F6;
            color: white;
        }
        
        .lucky-chart {
            display: none;
        }
        
        .lucky-chart.active {
            display: block;
        }
        
        @media print {
            .no-print {
                display: none !important;
            }
            .bingo-card {
                break-inside: avoid;
                margin-bottom: 20px;
            }
        }
        
        .cards-section {
            display: none;
        }
        
        .cards-section.visible {
            display: block;
        }
        
        .cards-placeholder {
            text-align: center;
            padding: 3rem;
            background-color: #f8fafc;
            border-radius: 0.75rem;
            border: 2px dashed #cbd5e0;
        }
        
        .cards-placeholder i {
            font-size: 3rem;
            color: #9ca3af;
            margin-bottom: 1rem;
        }
        
        .sample-screenshot {
            max-width: 100%;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-top: 10px;
        }
        
        .probability-indicator {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            margin-top: 0.5rem;
        }
        
        .high-probability {
            background-color: #10B981;
            color: white;
        }
        
        .medium-probability {
            background-color: #F59E0B;
            color: white;
        }
        
        .low-probability {
            background-color: #EF4444;
            color: white;
        }
        
        .winning-pattern {
            background-color: #8B5CF6;
            color: white;
            padding: 0.5rem;
            border-radius: 0.5rem;
            margin-top: 0.5rem;
            font-weight: bold;
            text-align: center;
        }
        
        .edit-mode {
            border: 2px solid #EF4444;
            box-shadow: 0 0 10px rgba(239, 68, 68, 0.3);
        }
        
        .edit-input {
            width: 100%;
            text-align: center;
            border: none;
            background: transparent;
            font-weight: bold;
            font-size: 1rem;
        }
        
        .edit-input:focus {
            outline: none;
        }
        
        .edit-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 1rem;
        }
        
        .frequency-section {
            margin-top: 1.5rem;
        }
        
        .frequency-category {
            margin-bottom: 1rem;
        }
        
        .frequency-title {
            font-weight: bold;
            margin-bottom: 0.5rem;
            padding: 0.5rem;
            border-radius: 0.25rem;
        }
        
        .frequency-5 {
            background-color: #10B981;
            color: white;
        }
        
        .frequency-4 {
            background-color: #3B82F6;
            color: white;
        }
        
        .frequency-3 {
            background-color: #F59E0B;
            color: white;
        }
        
        .frequency-2 {
            background-color: #EF4444;
            color: white;
        }
        
        .frequency-1 {
            background-color: #6B7280;
            color: white;
        }
        
        .frequency-numbers {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .frequency-badge {
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-weight: bold;
        }
        
        .screenshot-analysis {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #F3F4F6;
            border-radius: 0.5rem;
        }
        
        .screenshot-numbers {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        /* New styles for frequency-based generation */
        .generation-options {
            margin-top: 1.5rem;
            padding: 1rem;
            background-color: #F0F9FF;
            border-radius: 0.5rem;
            border: 1px solid #BAE6FD;
        }
        
        .generation-option {
            display: flex;
            align-items: center;
            margin-bottom: 0.75rem;
            padding: 0.75rem;
            background-color: white;
            border-radius: 0.5rem;
            border: 1px solid #E5E7EB;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .generation-option:hover {
            border-color: #3B82F6;
            box-shadow: 0 2px 4px rgba(59, 130, 246, 0.1);
        }
        
        .generation-option.selected {
            border-color: #3B82F6;
            background-color: #EFF6FF;
        }
        
        .option-radio {
            margin-right: 0.75rem;
        }
        
        .option-content {
            flex: 1;
        }
        
        .option-title {
            font-weight: 600;
            color: #1E40AF;
        }
        
        .option-description {
            font-size: 0.875rem;
            color: #6B7280;
            margin-top: 0.25rem;
        }
        
        .option-numbers {
            font-size: 0.75rem;
            color: #374151;
            margin-top: 0.25rem;
        }
        
        /* New styles for percentage controls */
        .percentage-controls {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #FEF3C7;
            border-radius: 0.5rem;
            border: 1px solid #F59E0B;
            display: none;
        }
        
        .percentage-controls.active {
            display: block;
        }
        
        .percentage-control {
            margin-bottom: 1rem;
        }
        
        .percentage-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #92400E;
        }
        
        .percentage-value {
            font-weight: bold;
            color: #B45309;
        }
        
        .percentage-slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #E5E7EB;
            outline: none;
            -webkit-appearance: none;
        }
        
        .percentage-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #F59E0B;
            cursor: pointer;
        }
        
        .percentage-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #F59E0B;
            cursor: pointer;
            border: none;
        }
        
        .percentage-preview {
            font-size: 0.875rem;
            color: #92400E;
            margin-top: 0.5rem;
            text-align: center;
            font-weight: 600;
        }
    </style>
</head>

<body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen font-sans">
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-blue-800 mb-2">Bingo Card Generator</h1>
            <p class="text-lg text-blue-600">Create up to 25 bingo cards using Bingo Plus results</p>
        </header>

        <main class="max-w-6xl mx-auto">
            <div class="grid md:grid-cols-2 gap-8 mb-12">
                <!-- Upload Section -->
                <div class="bg-white rounded-xl shadow-lg p-6 no-print">
                    <h2 class="text-2xl font-bold text-blue-800 mb-4">Upload Screenshots</h2>
                    <p class="text-gray-600 mb-6">Upload your Bingo Plus screenshots.</p>

                    <div class="drag-area border-2 border-dashed border-blue-300 rounded-lg p-6 text-center mb-6 bg-blue-50" id="drag-area">
                        <i class="fas fa-cloud-upload-alt text-blue-500 text-4xl mb-3"></i>
                        <p class="text-blue-700 font-medium mb-2">Drag & Drop your screenshots here</p>
                        <p class="text-blue-500 text-sm">or</p>
                        <label for="file-upload" class="mt-3 cursor-pointer inline-block bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors">
                            <i class="fas fa-file-image mr-2"></i>Browse Files
                        </label>
                        <input id="file-upload" type="file" accept="image/*" class="hidden" multiple>
                    </div>

                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-blue-800 mb-3">Uploaded Screenshots</h3>
                        <div class="grid grid-cols-3 gap-3" id="uploaded-images"></div>
                    </div>

                    <!-- Sample Screenshot -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-blue-800 mb-2">Sample Screenshot</h3>
                        <div class="bg-gray-100 p-4 rounded-lg">
                            <p class="text-gray-600 mb-2">Here's an example of what a Bingo Plus screenshot looks like:</p>
                            <div class="bg-white p-4 rounded-lg border border-gray-300 inline-block">
                                <div class="text-center font-bold text-lg mb-2">BINGO PLUS</div>
                                <div class="grid grid-cols-5 gap-1 mb-2">
                                    <div class="bg-blue-500 text-white p-2 text-center rounded">B</div>
                                    <div class="bg-red-500 text-white p-2 text-center rounded">I</div>
                                    <div class="bg-gray-500 text-white p-2 text-center rounded">N</div>
                                    <div class="bg-green-500 text-white p-2 text-center rounded">G</div>
                                    <div class="bg-yellow-500 text-white p-2 text-center rounded">O</div>
                                </div>
                                <div class="text-center text-sm text-gray-600">Numbers: 5, 12, 23, 34, 45, 56, 67, 70</div>
                                <div class="text-center text-xs text-gray-500 mt-2">Upload screenshots like this for analysis</div>
                            </div>
                        </div>
                    </div>

                    <button class="w-full bg-indigo-600 hover:bg-indigo-700 text-white py-3 rounded-lg font-semibold flex items-center justify-center mb-6" id="analyze-btn">
                        <i class="fas fa-search mr-2"></i> Analyze Screenshots for Numbers
                    </button>

                    <!-- Lucky Numbers Section - Initially hidden -->
                    <div class="mb-4 hidden" id="lucky-numbers-section">
                        <h3 class="text-lg font-semibold text-blue-800 mb-2">Lucky Numbers</h3>

                        <!-- Lucky Numbers Tabs -->
                        <div class="grid grid-cols-4 gap-1 mb-4 bg-gray-100 rounded-lg p-1">
                            <button class="lucky-chart-tab rounded-md text-center font-medium active" data-chart="20">
                                Lucky 20
                            </button>
                            <button class="lucky-chart-tab rounded-md text-center font-medium" data-chart="25">
                                Lucky 25
                            </button>
                            <button class="lucky-chart-tab rounded-md text-center font-medium" data-chart="30">
                                Lucky 30
                            </button>
                            <button class="lucky-chart-tab rounded-md text-center font-medium" data-chart="35">
                                Lucky 35
                            </button>
                            <button class="lucky-chart-tab rounded-md text-center font-medium" data-chart="40">
                                Lucky 40
                            </button>
                            <button class="lucky-chart-tab rounded-md text-center font-medium" data-chart="44">
                                Lucky 44
                            </button>
                            <button class="lucky-chart-tab rounded-md text-center font-medium" data-chart="48">
                                Lucky 48
                            </button>
                        </div>

                        <!-- Lucky Numbers Charts -->
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <!-- Lucky 20 Chart -->
                            <div id="lucky-chart-20" class="lucky-chart active">
                                <div class="grid grid-cols-5 gap-2 mb-4">
                                    <div class="text-center font-bold text-blue-800">B (1-15)</div>
                                    <div class="text-center font-bold text-red-600">I (16-30)</div>
                                    <div class="text-center font-bold text-gray-600">N (31-45)</div>
                                    <div class="text-center font-bold text-green-600">G (46-60)</div>
                                    <div class="text-center font-bold text-yellow-600">O (61-75)</div>
                                </div>
                                <div id="lucky-numbers-20" class="flex flex-wrap gap-2">
                                    <span class="text-gray-500">No lucky numbers detected yet</span>
                                </div>
                            </div>

                            <!-- Lucky 25 Chart -->
                            <div id="lucky-chart-25" class="lucky-chart">
                                <div class="grid grid-cols-5 gap-2 mb-4">
                                    <div class="text-center font-bold text-blue-800">B (1-15)</div>
                                    <div class="text-center font-bold text-red-600">I (16-30)</div>
                                    <div class="text-center font-bold text-gray-600">N (31-45)</div>
                                    <div class="text-center font-bold text-green-600">G (46-60)</div>
                                    <div class="text-center font-bold text-yellow-600">O (61-75)</div>
                                </div>
                                <div id="lucky-numbers-25" class="flex flex-wrap gap-2">
                                    <span class="text-gray-500">No lucky numbers detected yet</span>
                                </div>
                            </div>

                            <!-- Lucky 30 Chart -->
                            <div id="lucky-chart-30" class="lucky-chart">
                                <div class="grid grid-cols-5 gap-2 mb-4">
                                    <div class="text-center font-bold text-blue-800">B (1-15)</div>
                                    <div class="text-center font-bold text-red-600">I (16-30)</div>
                                    <div class="text-center font-bold text-gray-600">N (31-45)</div>
                                    <div class="text-center font-bold text-green-600">G (46-60)</div>
                                    <div class="text-center font-bold text-yellow-600">O (61-75)</div>
                                </div>
                                <div id="lucky-numbers-30" class="flex flex-wrap gap-2">
                                    <span class="text-gray-500">No lucky numbers detected yet</span>
                                </div>
                            </div>

                            <!-- Lucky 35 Chart -->
                            <div id="lucky-chart-35" class="lucky-chart">
                                <div class="grid grid-cols-5 gap-2 mb-4">
                                    <div class="text-center font-bold text-blue-800">B (1-15)</div>
                                    <div class="text-center font-bold text-red-600">I (16-30)</div>
                                    <div class="text-center font-bold text-gray-600">N (31-45)</div>
                                    <div class="text-center font-bold text-green-600">G (46-60)</div>
                                    <div class="text-center font-bold text-yellow-600">O (61-75)</div>
                                </div>
                                <div id="lucky-numbers-35" class="flex flex-wrap gap-2">
                                    <span class="text-gray-500">No lucky numbers detected yet</span>
                                </div>
                            </div>

                            <!-- Lucky 40 Chart -->
                            <div id="lucky-chart-40" class="lucky-chart">
                                <div class="grid grid-cols-5 gap-2 mb-4">
                                    <div class="text-center font-bold text-blue-800">B (1-15)</div>
                                    <div class="text-center font-bold text-red-600">I (16-30)</div>
                                    <div class="text-center font-bold text-gray-600">N (31-45)</div>
                                    <div class="text-center font-bold text-green-600">G (46-60)</div>
                                    <div class="text-center font-bold text-yellow-600">O (61-75)</div>
                                </div>
                                <div id="lucky-numbers-40" class="flex flex-wrap gap-2">
                                    <span class="text-gray-500">No lucky numbers detected yet</span>
                                </div>
                            </div>

                            <!-- Lucky 44 Chart -->
                            <div id="lucky-chart-44" class="lucky-chart">
                                <div class="grid grid-cols-5 gap-2 mb-4">
                                    <div class="text-center font-bold text-blue-800">B (1-15)</div>
                                    <div class="text-center font-bold text-red-600">I (16-30)</div>
                                    <div class="text-center font-bold text-gray-600">N (31-45)</div>
                                    <div class="text-center font-bold text-green-600">G (46-60)</div>
                                    <div class="text-center font-bold text-yellow-600">O (61-75)</div>
                                </div>
                                <div id="lucky-numbers-44" class="flex flex-wrap gap-2">
                                    <span class="text-gray-500">No lucky numbers detected yet</span>
                                </div>
                            </div>

                            <!-- Lucky 48 Chart -->
                            <div id="lucky-chart-48" class="lucky-chart">
                                <div class="grid grid-cols-5 gap-2 mb-4">
                                    <div class="text-center font-bold text-blue-800">B (1-15)</div>
                                    <div class="text-center font-bold text-red-600">I (16-30)</div>
                                    <div class="text-center font-bold text-gray-600">N (31-45)</div>
                                    <div class="text-center font-bold text-green-600">G (46-60)</div>
                                    <div class="text-center font-bold text-yellow-600">O (61-75)</div>
                                </div>
                                <div id="lucky-numbers-48" class="flex flex-wrap gap-2">
                                    <span class="text-gray-500">No lucky numbers detected yet</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Frequency Analysis Section - Initially hidden -->
                    <div class="frequency-section hidden" id="frequency-section">
                        <h3 class="text-lg font-semibold text-blue-800 mb-2">Number Frequency Analysis</h3>
                        <p class="text-gray-600 mb-4">Numbers categorized by appearance frequency across screenshots:</p>

                        <!-- Screenshot Analysis -->
                        <div class="screenshot-analysis">
                            <h4 class="font-semibold text-blue-700 mb-2">Detected Numbers by Screenshot</h4>
                            <div id="screenshot-analysis-container"></div>
                        </div>

                        <div class="frequency-category">
                            <div class="frequency-title frequency-5">Appeared 5 times</div>
                            <div id="frequency-5" class="frequency-numbers">
                                <span class="text-gray-500">No numbers in this category</span>
                            </div>
                        </div>

                        <div class="frequency-category">
                            <div class="frequency-title frequency-4">Appeared 4 times</div>
                            <div id="frequency-4" class="frequency-numbers">
                                <span class="text-gray-500">No numbers in this category</span>
                            </div>
                        </div>

                        <div class="frequency-category">
                            <div class="frequency-title frequency-3">Appeared 3 times</div>
                            <div id="frequency-3" class="frequency-numbers">
                                <span class="text-gray-500">No numbers in this category</span>
                            </div>
                        </div>

                        <div class="frequency-category">
                            <div class="frequency-title frequency-2">Appeared 2 times</div>
                            <div id="frequency-2" class="frequency-numbers">
                                <span class="text-gray-500">No numbers in this category</span>
                            </div>
                        </div>

                        <div class="frequency-category">
                            <div class="frequency-title frequency-1">Appeared 1 time</div>
                            <div id="frequency-1" class="frequency-numbers">
                                <span class="text-gray-500">No numbers in this category</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card Configuration -->
                <div class="bg-white rounded-xl shadow-lg p-6 no-print">
                    <h2 class="text-2xl font-bold text-blue-800 mb-4">Card Configuration</h2>

                    <div class="mb-6">
                        <label class="block text-blue-800 font-medium mb-2">Number of Cards (Max 25)</label>
                        <div class="flex items-center">
                            <button class="bg-blue-200 text-blue-800 w-10 h-10 rounded-l-lg" id="decrease-cards"><i class="fas fa-minus"></i></button>
                            <input type="number" min="1" max="25" value="3" class="w-16 h-10 text-center border-t border-b border-blue-200" id="card-count">
                            <button class="bg-blue-200 text-blue-800 w-10 h-10 rounded-r-lg" id="increase-cards"><i class="fas fa-plus"></i></button>
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="flex items-center">
                            <input type="checkbox" class="rounded text-blue-600 mr-2" id="include-free-space" checked>
                            <span class="text-blue-800">Include free space in center</span>
                        </label>
                    </div>

                    <!-- NEW: Frequency-based Generation Options -->
                    <div class="generation-options">
                        <h3 class="text-lg font-semibold text-blue-800 mb-3">Generation Strategy</h3>
                        <p class="text-gray-600 mb-4">Choose how to generate bingo cards based on number frequency:</p>
                        
                        <div class="generation-option selected" data-strategy="high-frequency">
                            <div class="option-radio">
                                <input type="radio" name="generation-strategy" id="strategy-high" checked>
                            </div>
                            <div class="option-content">
                                <div class="option-title">High Frequency Numbers</div>
                                <div class="option-description">Use numbers that appeared most frequently (4+ times)</div>
                                <div class="option-numbers" id="high-frequency-numbers">8, 13, 14, 18, 23, 28, 43, 54, 66</div>
                            </div>
                        </div>
                        
                        <div class="generation-option" data-strategy="medium-frequency">
                            <div class="option-radio">
                                <input type="radio" name="generation-strategy" id="strategy-medium">
                            </div>
                            <div class="option-content">
                                <div class="option-title">Medium Frequency Numbers</div>
                                <div class="option-description">Use numbers that appeared 3 times</div>
                                <div class="option-numbers" id="medium-frequency-numbers">5, 6, 15, 16, 20, 27, 30, 31, 32, 35, 41, 45, 47, 52, 55, 56, 60, 61, 64, 65, 67, 68, 69, 70, 73, 75</div>
                            </div>
                        </div>
                        
                        <div class="generation-option" data-strategy="low-frequency">
                            <div class="option-radio">
                                <input type="radio" name="generation-strategy" id="strategy-low">
                            </div>
                            <div class="option-content">
                                <div class="option-title">Low Frequency Numbers</div>
                                <div class="option-description">Use numbers that appeared 1-2 times</div>
                                <div class="option-numbers" id="low-frequency-numbers">1, 2, 3, 4, 7, 9, 10, 11, 12, 17, 19, 21, 22, 24, 25, 26, 29, 33, 34, 36, 37, 38, 39, 40, 42, 46, 48, 49, 50, 51, 53, 57, 58, 59, 62, 63, 71, 72, 74</div>
                            </div>
                        </div>
                        
                        <div class="generation-option" data-strategy="balanced">
                            <div class="option-radio">
                                <input type="radio" name="generation-strategy" id="strategy-balanced">
                            </div>
                            <div class="option-content">
                                <div class="option-title">Balanced Distribution</div>
                                <div class="option-description">Mix numbers from all frequency categories</div>
                                <div class="option-numbers">Combines high, medium, and low frequency numbers</div>
                            </div>
                        </div>

                        <!-- Percentage Controls for Medium and Low Frequency -->
                        <div class="percentage-controls" id="percentage-controls">
                            <h4 class="font-semibold text-yellow-800 mb-3">Adjust Number Distribution</h4>
                            
                            <div class="percentage-control">
                                <div class="percentage-label">
                                    <span>Medium Frequency Numbers</span>
                                    <span class="percentage-value" id="medium-percentage-value">25%</span>
                                </div>
                                <input type="range" min="0" max="100" value="25" class="percentage-slider" id="medium-percentage-slider">
                                <div class="percentage-preview" id="medium-preview">~6 numbers per card</div>
                            </div>
                            
                            <div class="percentage-control">
                                <div class="percentage-label">
                                    <span>Low Frequency Numbers</span>
                                    <span class="percentage-value" id="low-percentage-value">75%</span>
                                </div>
                                <input type="range" min="0" max="100" value="75" class="percentage-slider" id="low-percentage-slider">
                                <div class="percentage-preview" id="low-preview">~18 numbers per card</div>
                            </div>
                            
                            <div class="text-xs text-yellow-700 mt-2">
                                <i class="fas fa-info-circle mr-1"></i>
                                These percentages control how many medium vs low frequency numbers are used in your cards
                            </div>
                        </div>
                    </div>

                    <!-- Winning Pattern Selector -->
                    <div class="mb-6">
                        <label class="block text-blue-800 font-medium mb-2">Winning Pattern</label>
                        <div class="grid grid-cols-2 gap-3" id="pattern-selection">
                            <!-- Pattern options remain the same -->
                            <div class="pattern-selection border-2 border-gray-200 rounded-lg p-3 text-center" data-pattern="none">
                                <div class="pattern-preview mb-2">
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                </div>
                                <span class="text-sm font-medium">None</span>
                            </div>
                            <div class="pattern-selection border-2 border-gray-200 rounded-lg p-3 text-center" data-pattern="four-corners">
                                <div class="pattern-preview mb-2">
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                </div>
                                <span class="text-sm font-medium">Four Corners</span>
                            </div>
                            <div class="pattern-selection border-2 border-gray-200 rounded-lg p-3 text-center" data-pattern="x">
                                <div class="pattern-preview mb-2">
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                </div>
                                <span class="text-sm font-medium">X Pattern</span>
                            </div>
                            <div class="pattern-selection border-2 border-gray-200 rounded-lg p-3 text-center" data-pattern="line">
                                <div class="pattern-preview mb-2">
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                </div>
                                <span class="text-sm font-medium">T Pattern</span>
                            </div>
                            <div class="pattern-selection border-2 border-gray-200 rounded-lg p-3 text-center" data-pattern="hallow">
                                <div class="pattern-preview mb-2">
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                </div>
                                <span class="text-sm font-medium">Hallow</span>
                            </div>
                            <div class="pattern-selection border-2 border-gray-200 rounded-lg p-3 text-center" data-pattern="blackout">
                                <div class="pattern-preview mb-2">
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                    <div class="pattern-cell active"></div>
                                </div>
                                <span class="text-sm font-medium">Blackout</span>
                            </div>
                        </div>
                    </div>

                    <button class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-semibold flex items-center justify-center" id="generate-btn">
                        <i class="fas fa-magic mr-2"></i> Generate Bingo Cards
                    </button>
                </div>
            </div>

            <!-- Generated Cards Section - Initially hidden -->
            <div class="cards-section bg-white rounded-xl shadow-lg p-6" id="cards-section">
                <div class="flex justify-between items-center mb-6 no-print">
                    <h2 class="text-2xl font-bold text-blue-800">Generated Bingo Cards</h2>
                    <div class="flex space-x-2">
                        <button class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg flex items-center" id="download-btn">
                            <i class="fas fa-download mr-2"></i> Download All
                        </button>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg flex items-center" id="print-btn">
                            <i class="fas fa-print mr-2"></i> Print Cards
                        </button>
                        <button class="bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-lg flex items-center" id="edit-btn">
                            <i class="fas fa-edit mr-2"></i> Edit Cards
                        </button>
                    </div>
                </div>

                <!-- Placeholder when no cards are generated -->
                <div class="cards-placeholder" id="cards-placeholder">
                    <i class="fas fa-dice"></i>
                    <h3 class="text-xl font-semibold text-gray-600 mb-2">No Bingo Cards Generated Yet</h3>
                    <p class="text-gray-500">Configure your settings and click "Generate Bingo Cards" to create your cards.</p>
                </div>

                <!-- Container for generated cards -->
                <div class="grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="cards-container"></div>
            </div>
        </main>

        <footer class="mt-12 text-center text-blue-600 no-print">
            <p>© 2023 Bingo Card Generator | Created for Bingo Plus players</p>
        </footer>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const CARDS_LIMIT = 25;
            const cardCountInput = document.getElementById('card-count');
            const decreaseBtn = document.getElementById('decrease-cards');
            const increaseBtn = document.getElementById('increase-cards');
            const generateBtn = document.getElementById('generate-btn');
            const printBtn = document.getElementById('print-btn');
            const downloadBtn = document.getElementById('download-btn');
            const editBtn = document.getElementById('edit-btn');
            const cardsContainer = document.getElementById('cards-container');
            const cardsSection = document.getElementById('cards-section');
            const cardsPlaceholder = document.getElementById('cards-placeholder');
            const dragArea = document.getElementById('drag-area');
            const fileUpload = document.getElementById('file-upload');
            const uploadedImagesContainer = document.getElementById('uploaded-images');
            const analyzeBtn = document.getElementById('analyze-btn');
            const patternSelection = document.getElementById('pattern-selection');
            const luckyNumbersSection = document.getElementById('lucky-numbers-section');
            const frequencySection = document.getElementById('frequency-section');
            const luckyChartTabs = document.querySelectorAll('.lucky-chart-tab');
            const generationOptions = document.querySelectorAll('.generation-option');
            const percentageControls = document.getElementById('percentage-controls');
            const mediumPercentageSlider = document.getElementById('medium-percentage-slider');
            const lowPercentageSlider = document.getElementById('low-percentage-slider');
            const mediumPercentageValue = document.getElementById('medium-percentage-value');
            const lowPercentageValue = document.getElementById('low-percentage-value');
            const mediumPreview = document.getElementById('medium-preview');
            const lowPreview = document.getElementById('low-preview');

            let calledNumbers = [];
            let uploadedFiles = [];
            let selectedPattern = 'none';
            let cardsGenerated = false;
            let analyzedNumbers = [];
            let numberFrequency = {};
            let isEditMode = false;
            let screenshotNumbers = {};
            let selectedGenerationStrategy = 'high-frequency';
            let mediumPercentage = 25;
            let lowPercentage = 75;

            const COL_KEYS = ['B', 'I', 'N', 'G', 'O'];
            const COL_RANGES = {
                B: [1, 15],
                I: [16, 30],
                N: [31, 45],
                G: [46, 60],
                O: [61, 75]
            };

            // Card count controls
            decreaseBtn.addEventListener('click', () => {
                if (cardCountInput.value > 1) cardCountInput.value--;
            });
            increaseBtn.addEventListener('click', () => {
                if (cardCountInput.value < CARDS_LIMIT) cardCountInput.value++;
            });

            generateBtn.addEventListener('click', generateCards);
            printBtn.addEventListener('click', () => window.print());
            downloadBtn.addEventListener('click', downloadCards);
            editBtn.addEventListener('click', toggleEditMode);
            analyzeBtn.addEventListener('click', analyzeScreenshots);

            // Pattern selection
            patternSelection.querySelectorAll('.pattern-selection').forEach(el => {
                el.addEventListener('click', () => {
                    patternSelection.querySelectorAll('.pattern-selection').forEach(e => {
                        e.classList.remove('selected');
                    });
                    el.classList.add('selected');
                    selectedPattern = el.dataset.pattern;
                });
            });

            // Generation strategy selection
            generationOptions.forEach(option => {
                option.addEventListener('click', () => {
                    generationOptions.forEach(opt => {
                        opt.classList.remove('selected');
                        opt.querySelector('input').checked = false;
                    });
                    option.classList.add('selected');
                    option.querySelector('input').checked = true;
                    selectedGenerationStrategy = option.dataset.strategy;
                    
                    // Show/hide percentage controls based on selection
                    if (selectedGenerationStrategy === 'medium-frequency' || selectedGenerationStrategy === 'low-frequency') {
                        percentageControls.classList.add('active');
                        updatePercentagePreviews();
                    } else {
                        percentageControls.classList.remove('active');
                    }
                });
            });

            // Percentage slider controls
            mediumPercentageSlider.addEventListener('input', function() {
                mediumPercentage = parseInt(this.value);
                lowPercentage = 100 - mediumPercentage;
                
                mediumPercentageValue.textContent = mediumPercentage + '%';
                lowPercentageValue.textContent = lowPercentage + '%';
                lowPercentageSlider.value = lowPercentage;
                
                updatePercentagePreviews();
            });

            lowPercentageSlider.addEventListener('input', function() {
                lowPercentage = parseInt(this.value);
                mediumPercentage = 100 - lowPercentage;
                
                lowPercentageValue.textContent = lowPercentage + '%';
                mediumPercentageValue.textContent = mediumPercentage + '%';
                mediumPercentageSlider.value = mediumPercentage;
                
                updatePercentagePreviews();
            });

            function updatePercentagePreviews() {
                const mediumCount = Math.round(24 * (mediumPercentage / 100));
                const lowCount = 24 - mediumCount;
                
                mediumPreview.textContent = `~${mediumCount} numbers per card`;
                lowPreview.textContent = `~${lowCount} numbers per card`;
            }

            // Lucky chart tabs
            luckyChartTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remove active class from all tabs
                    luckyChartTabs.forEach(t => t.classList.remove('active'));
                    // Add active class to clicked tab
                    tab.classList.add('active');

                    // Hide all charts
                    document.querySelectorAll('.lucky-chart').forEach(chart => {
                        chart.classList.remove('active');
                    });

                    // Show selected chart
                    const chartId = `lucky-chart-${tab.dataset.chart}`;
                    document.getElementById(chartId).classList.add('active');
                });
            });

            // Set default pattern
            patternSelection.querySelector('.pattern-selection[data-pattern="none"]').classList.add('selected');

            // Drag & drop upload
            dragArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                dragArea.classList.add('active');
            });
            dragArea.addEventListener('dragleave', () => dragArea.classList.remove('active'));
            dragArea.addEventListener('drop', (e) => {
                e.preventDefault();
                dragArea.classList.remove('active');
                handleFiles(e.dataTransfer.files);
            });
            fileUpload.addEventListener('change', (e) => handleFiles(e.target.files));

            function handleFiles(files) {
                for (let i = 0; i < files.length; i++) {
                    if (files[i].type.startsWith('image/')) {
                        uploadedFiles.push(files[i]);
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const imgDiv = document.createElement('div');
                            imgDiv.className = 'relative';
                            const img = document.createElement('img');
                            img.src = e.target.result;
                            img.className = 'uploaded-image border border-gray-200';
                            const removeBtn = document.createElement('button');
                            removeBtn.className = 'absolute top-0 right-0 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs';
                            removeBtn.innerHTML = '&times;';
                            removeBtn.onclick = () => {
                                imgDiv.remove();
                                uploadedFiles = uploadedFiles.filter(f => f !== files[i]);
                            };
                            imgDiv.appendChild(img);
                            imgDiv.appendChild(removeBtn);
                            uploadedImagesContainer.appendChild(imgDiv);
                        };
                        reader.readAsDataURL(files[i]);
                    }
                }
            }

            // Enhanced OCR analysis that processes uploaded screenshots
            function analyzeScreenshots() {
                if (uploadedFiles.length === 0) {
                    alert('Please upload at least one screenshot first!');
                    return;
                }
                analyzeBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Analyzing...';
                analyzeBtn.classList.add('analysis-animation');

                setTimeout(() => {
                    // Enhanced analysis: Extract numbers from uploaded screenshots
                    analyzedNumbers = [];
                    numberFrequency = {};
                    screenshotNumbers = {};

                    // Initialize frequency tracking
                    for (let i = 1; i <= 75; i++) {
                        numberFrequency[i] = 0;
                    }

                    // Process each uploaded screenshot
                    for (let i = 0; i < uploadedFiles.length; i++) {
                        const screenshotName = `Screenshot ${i+1}`;

                        // Simulate OCR extraction from the actual uploaded image
                        const extractedNumbers = extractNumbersFromUploadedImage(uploadedFiles[i], i);

                        screenshotNumbers[screenshotName] = extractedNumbers;

                        // Count frequency of each number
                        extractedNumbers.forEach(num => {
                            numberFrequency[num]++;
                        });
                    }

                    // Get all unique numbers that appeared (for analyzedNumbers)
                    analyzedNumbers = Object.keys(numberFrequency)
                        .filter(num => numberFrequency[num] > 0)
                        .map(num => parseInt(num))
                        .sort((a, b) => a - b);

                    // Generate different sets of numbers for each chart
                    const lucky20Numbers = generateLuckyNumbers(20, analyzedNumbers, numberFrequency);
                    const lucky25Numbers = generateLuckyNumbers(25, analyzedNumbers, numberFrequency);
                    const lucky30Numbers = generateLuckyNumbers(30, analyzedNumbers, numberFrequency);
                    const lucky35Numbers = generateLuckyNumbers(35, analyzedNumbers, numberFrequency);
                    const lucky40Numbers = generateLuckyNumbers(40, analyzedNumbers, numberFrequency);
                    const lucky44Numbers = generateLuckyNumbers(44, analyzedNumbers, numberFrequency);
                    const lucky48Numbers = generateLuckyNumbers(48, analyzedNumbers, numberFrequency);

                    // Use the 20-number set for bingo cards
                    calledNumbers = lucky20Numbers;

                    // Update all lucky number charts
                    updateLuckyNumbersChart('20', lucky20Numbers);
                    updateLuckyNumbersChart('25', lucky25Numbers);
                    updateLuckyNumbersChart('30', lucky30Numbers);
                    updateLuckyNumbersChart('35', lucky35Numbers);
                    updateLuckyNumbersChart('40', lucky40Numbers);
                    updateLuckyNumbersChart('44', lucky44Numbers);
                    updateLuckyNumbersChart('48', lucky48Numbers);

                    // Update generation options with actual numbers
                    updateGenerationOptions();

                    // Show frequency analysis
                    updateFrequencyAnalysis();

                    // Show screenshot analysis
                    updateScreenshotAnalysis();

                    // Show lucky numbers section after analysis
                    luckyNumbersSection.classList.remove('hidden');
                    frequencySection.classList.remove('hidden');

                    analyzeBtn.innerHTML = '<i class="fas fa-search mr-2"></i> Analyze Screenshots for Numbers';
                    analyzeBtn.classList.remove('analysis-animation');

                    // Show analysis summary
                    showAnalysisSummary();
                }, 2000);
            }

            function updateGenerationOptions() {
                // Group numbers by frequency
                const highFreqNumbers = [];
                const mediumFreqNumbers = [];
                const lowFreqNumbers = [];

                for (let num = 1; num <= 75; num++) {
                    const freq = numberFrequency[num];
                    if (freq >= 4) {
                        highFreqNumbers.push(num);
                    } else if (freq === 3) {
                        mediumFreqNumbers.push(num);
                    } else if (freq >= 1) {
                        lowFreqNumbers.push(num);
                    }
                }

                // Update the UI with actual numbers
                document.getElementById('high-frequency-numbers').textContent = highFreqNumbers.join(', ');
                document.getElementById('medium-frequency-numbers').textContent = mediumFreqNumbers.join(', ');
                document.getElementById('low-frequency-numbers').textContent = lowFreqNumbers.join(', ');
            }

            // Simulate OCR extraction from uploaded images
            function extractNumbersFromUploadedImage(file, index) {
                // This simulates what an OCR system would extract
                // Based on the screenshot index, return different number sets
                const screenshotData = [
                    [9, 1, 2, 6, 71, 45, 19, 26, 51, 28, 40, 15, 56, 73, 18, 54, 14, 12, 58, 75, 7, 49, 23, 8, 5, 61, 46, 64, 13, 24, 27, 72, 66, 4, 35, 48, 16, 70, 32, 65, 30, 41, 43, 68],
                    [38, 31, 13, 18, 12, 17, 53, 56, 74, 75, 3, 62, 73, 64, 55, 70, 20, 41, 36, 23, 8, 16, 67, 1, 52, 34, 43, 42, 21, 5, 29, 30, 28, 35, 14, 47, 45, 54, 46, 69, 65, 15, 66, 60],
                    [54, 66, 64, 67, 61, 15, 18, 8, 55, 4, 59, 52, 75, 14, 62, 6, 21, 32, 20, 25, 69, 31, 40, 65, 10, 16, 57, 23, 38, 73, 53, 17, 22, 47, 60, 27, 68, 72, 13, 28, 33, 43, 11, 19],
                    [61, 28, 39, 56, 35, 45, 67, 63, 49, 30, 60, 13, 34, 25, 66, 18, 5, 58, 54, 8, 47, 51, 68, 74, 7, 71, 37, 69, 52, 70, 14, 27, 41, 6, 32, 43, 50, 22, 20, 57, 31, 36, 23, 55]
                ];

                // Return data based on which screenshot is being processed
                // If we have more than 4 screenshots, cycle through the data
                const dataIndex = index % screenshotData.length;

                console.log(`Processing screenshot ${index + 1}, using data set ${dataIndex + 1}`);

                return [...screenshotData[dataIndex]];
            }

            function updateScreenshotAnalysis() {
                const container = document.getElementById('screenshot-analysis-container');
                container.innerHTML = '';

                Object.keys(screenshotNumbers).forEach(screenshotName => {
                    const screenshotDiv = document.createElement('div');
                    screenshotDiv.className = 'mb-3';

                    const title = document.createElement('div');
                    title.className = 'font-medium text-gray-700 mb-1';
                    title.textContent = `${screenshotName}:`;

                    const numbersDiv = document.createElement('div');
                    numbersDiv.className = 'screenshot-numbers';

                    screenshotNumbers[screenshotName].forEach(num => {
                        const badge = document.createElement('span');
                        badge.className = `frequency-badge ${getLuckyBadgeClass(num)}`;
                        badge.textContent = num;
                        numbersDiv.appendChild(badge);
                    });

                    screenshotDiv.appendChild(title);
                    screenshotDiv.appendChild(numbersDiv);
                    container.appendChild(screenshotDiv);
                });
            }

            function updateFrequencyAnalysis() {
                // Group numbers by frequency (only show numbers that appeared at least once)
                const frequencyGroups = {
                    5: [],
                    4: [],
                    3: [],
                    2: [],
                    1: []
                };

                // Populate frequency groups only for numbers that appeared
                for (let num = 1; num <= 75; num++) {
                    const frequency = numberFrequency[num];
                    if (frequency >= 5) {
                        frequencyGroups[5].push(num);
                    } else if (frequency === 4) {
                        frequencyGroups[4].push(num);
                    } else if (frequency === 3) {
                        frequencyGroups[3].push(num);
                    } else if (frequency === 2) {
                        frequencyGroups[2].push(num);
                    } else if (frequency === 1) {
                        frequencyGroups[1].push(num);
                    }
                    // Numbers with frequency 0 are not included
                }

                // Sort each group
                Object.keys(frequencyGroups).forEach(freq => {
                    frequencyGroups[freq].sort((a, b) => a - b);
                });

                // Update the UI for each frequency category
                for (let freq = 1; freq <= 5; freq++) {
                    const container = document.getElementById(`frequency-${freq}`);
                    container.innerHTML = '';

                    if (frequencyGroups[freq].length === 0) {
                        container.innerHTML = '<span class="text-gray-500">No numbers in this category</span>';
                    } else {
                        frequencyGroups[freq].forEach(num => {
                            const badge = document.createElement('span');
                            badge.className = `frequency-badge ${getLuckyBadgeClass(num)}`;
                            badge.textContent = num;
                            container.appendChild(badge);
                        });
                    }
                }
            }

            function showAnalysisSummary() {
                // Create a summary of the analysis
                const summaryDiv = document.createElement('div');
                summaryDiv.className = 'bg-green-50 p-4 rounded-lg mt-4';

                // Calculate coverage
                const appearedNumbers = Object.keys(numberFrequency).filter(num => numberFrequency[num] > 0).length;
                const coveragePercentage = ((appearedNumbers / 75) * 100).toFixed(1);

                // Find repeated numbers (appearing in multiple screenshots)
                const repeatedNumbers = Object.keys(numberFrequency)
                    .filter(num => numberFrequency[num] > 1)
                    .map(num => parseInt(num))
                    .sort((a, b) => a - b);

                let summaryHTML = `
                <h4 class="font-bold text-green-800 mb-2">Analysis Summary</h4>
                <p class="text-green-700">Analyzed ${uploadedFiles.length} screenshots and detected ${appearedNumbers} out of 75 numbers (${coveragePercentage}% coverage).</p>
            `;

                if (repeatedNumbers.length > 0) {
                    summaryHTML += `<p class="text-green-700 mt-2">Repeated numbers (appeared in multiple screenshots): ${repeatedNumbers.join(', ')}</p>`;
                }

                summaryHTML += `<p class="text-green-700 mt-2">Most frequent numbers: ${getMostFrequentNumbers(5).join(', ')}</p>`;

                summaryDiv.innerHTML = summaryHTML;

                // Insert after the lucky numbers section
                luckyNumbersSection.parentNode.insertBefore(summaryDiv, luckyNumbersSection.nextSibling);
            }

            function getMostFrequentNumbers(count) {
                // Sort numbers by frequency
                const sortedNumbers = Object.keys(numberFrequency)
                    .map(num => ({
                        num: parseInt(num),
                        freq: numberFrequency[num]
                    }))
                    .sort((a, b) => b.freq - a.freq)
                    .slice(0, count)
                    .map(item => item.num);

                return sortedNumbers;
            }

            function generateLuckyNumbers(count, baseNumbers, frequency) {
                let numbers = [];

                // Create weighted selection based on actual frequency
                let weightedNumbers = [];

                // Add numbers with higher frequency more times
                for (let num = 1; num <= 75; num++) {
                    const freq = frequency[num] || 0;
                    // Higher frequency = more chances to be selected
                    const weight = freq * 2 + 1; // At least 1 chance, plus bonus for frequency

                    for (let i = 0; i < weight; i++) {
                        weightedNumbers.push(num);
                    }
                }

                // Shuffle and pick unique numbers
                weightedNumbers = shuffleArray(weightedNumbers);

                // Pick unique numbers until we reach the count
                for (let num of weightedNumbers) {
                    if (!numbers.includes(num)) {
                        numbers.push(num);
                        if (numbers.length >= count) break;
                    }
                }

                // If we still need more numbers, fill with remaining numbers
                while (numbers.length < count) {
                    for (let num = 1; num <= 75; num++) {
                        if (!numbers.includes(num)) {
                            numbers.push(num);
                            if (numbers.length >= count) break;
                        }
                    }
                }

                return numbers.sort((a, b) => a - b);
            }

            function getLuckyBadgeClass(num) {
                if (num >= 1 && num <= 15) return 'lucky-badge-b';
                else if (num >= 16 && num <= 30) return 'lucky-badge-i';
                else if (num >= 31 && num <= 45) return 'lucky-badge-n';
                else if (num >= 46 && num <= 60) return 'lucky-badge-g';
                else if (num >= 61 && num <= 75) return 'lucky-badge-o';
                return '';
            }

            function updateLuckyNumbersChart(chartSize, numbers) {
                const container = document.getElementById(`lucky-numbers-${chartSize}`);
                container.innerHTML = '';

                if (numbers.length === 0) {
                    container.innerHTML = '<span class="text-gray-500">No lucky numbers detected yet</span>';
                    return;
                }

                numbers.forEach(num => {
                    const badge = document.createElement('span');
                    badge.className = `px-3 py-1 rounded-full number-badge ${getLuckyBadgeClass(num)}`;
                    badge.textContent = num;
                    container.appendChild(badge);
                });
            }

            function getNumberClass(num) {
                if (num >= 1 && num <= 15) return 'number-b';
                else if (num >= 16 && num <= 30) return 'number-i';
                else if (num >= 31 && num <= 45) return 'number-n';
                else if (num >= 46 && num <= 60) return 'number-g';
                else if (num >= 61 && num <= 75) return 'number-o';
                return '';
            }

            function groupNumbersByColumn() {
                let layout = {
                    B: [],
                    I: [],
                    N: [],
                    G: [],
                    O: []
                };

                // Get numbers based on selected generation strategy
                let selectedNumbers = [];
                
                if (selectedGenerationStrategy === 'high-frequency') {
                    // Use numbers that appeared 4+ times
                    for (let num = 1; num <= 75; num++) {
                        if (numberFrequency[num] >= 4) {
                            selectedNumbers.push(num);
                        }
                    }
                } else if (selectedGenerationStrategy === 'medium-frequency') {
                    // Use numbers that appeared 3 times
                    for (let num = 1; num <= 75; num++) {
                        if (numberFrequency[num] === 3) {
                            selectedNumbers.push(num);
                        }
                    }
                } else if (selectedGenerationStrategy === 'low-frequency') {
                    // Use numbers that appeared 1-2 times
                    for (let num = 1; num <= 75; num++) {
                        if (numberFrequency[num] >= 1 && numberFrequency[num] <= 2) {
                            selectedNumbers.push(num);
                        }
                    }
                } else if (selectedGenerationStrategy === 'balanced') {
                    // Use a balanced mix from all frequency categories
                    const highFreq = [];
                    const mediumFreq = [];
                    const lowFreq = [];
                    
                    for (let num = 1; num <= 75; num++) {
                        const freq = numberFrequency[num];
                        if (freq >= 4) {
                            highFreq.push(num);
                        } else if (freq === 3) {
                            mediumFreq.push(num);
                        } else if (freq >= 1) {
                            lowFreq.push(num);
                        }
                    }
                    
                    // Calculate how many of each type to use based on percentages
                    const mediumCount = Math.round(24 * (mediumPercentage / 100));
                    const lowCount = 24 - mediumCount;
                    const highCount = Math.min(8, highFreq.length); // Limit high frequency to 8
                    
                    // Mix numbers from all categories
                    selectedNumbers = [
                        ...shuffleArray(highFreq).slice(0, highCount),
                        ...shuffleArray(mediumFreq).slice(0, mediumCount),
                        ...shuffleArray(lowFreq).slice(0, lowCount)
                    ];
                }

                // If no numbers selected (e.g., no analysis done), use all numbers
                if (selectedNumbers.length === 0) {
                    for (let num = 1; num <= 75; num++) {
                        selectedNumbers.push(num);
                    }
                }

                // First, add any called numbers to their respective columns
                calledNumbers.forEach(num => {
                    if (num >= 1 && num <= 15) layout.B.push(num);
                    else if (num >= 16 && num <= 30) layout.I.push(num);
                    else if (num >= 31 && num <= 45) layout.N.push(num);
                    else if (num >= 46 && num <= 60) layout.G.push(num);
                    else if (num >= 61 && num <= 75) layout.O.push(num);
                });

                // Then fill each column with numbers from the selected strategy
                for (let key of COL_KEYS) {
                    const [min, max] = COL_RANGES[key];
                    
                    // Get numbers from selected strategy that fall in this column's range
                    const columnNumbers = selectedNumbers.filter(num => num >= min && num <= max);
                    
                    // If we don't have enough numbers, add random ones from the range
                    while (layout[key].length < 5) {
                        if (columnNumbers.length > 0) {
                            // Add from our selected numbers
                            const randomIndex = Math.floor(Math.random() * columnNumbers.length);
                            const num = columnNumbers[randomIndex];
                            if (!layout[key].includes(num)) {
                                layout[key].push(num);
                            }
                            // Remove the used number to avoid duplicates
                            columnNumbers.splice(randomIndex, 1);
                        } else {
                            // Add random number from the range
                            let n = Math.floor(Math.random() * (max - min + 1)) + min;
                            if (!layout[key].includes(n)) layout[key].push(n);
                        }
                    }
                    
                    layout[key] = shuffleArray(layout[key]).slice(0, 5);
                }
                return layout;
            }

            function shuffleArray(arr) {
                let copy = [...arr];
                for (let i = copy.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [copy[i], copy[j]] = [copy[j], copy[i]];
                }
                return copy;
            }

            function generateCards() {
                const cardCount = parseInt(cardCountInput.value);
                const includeFreeSpace = document.getElementById('include-free-space').checked;
                cardsContainer.innerHTML = '';

                // If no called numbers, generate some random ones for demo
                if (!calledNumbers || calledNumbers.length === 0) {
                    calledNumbers = generateLuckyNumbers(20, analyzedNumbers, numberFrequency);
                    updateLuckyNumbersChart('20', calledNumbers);
                }

                for (let i = 1; i <= cardCount; i++) {
                    const columnPools = groupNumbersByColumn();
                    const cardDiv = document.createElement('div');
                    cardDiv.className = 'border-2 border-blue-300 rounded-xl p-4 bg-blue-50 card-container';
                    cardDiv.dataset.cardId = i;

                    const cardTitle = document.createElement('h3');
                    cardTitle.className = 'text-center font-bold text-blue-800 mb-2';
                    cardTitle.textContent = `Card #${i}`;

                    const cardGrid = document.createElement('div');
                    cardGrid.className = 'grid grid-cols-5 gap-1 mx-auto max-w-xs bingo-card';

                    // Column headers
                    COL_KEYS.forEach(l => {
                        const h = document.createElement('div');
                        h.className = 'bg-blue-100 text-blue-800 font-bold rounded-lg p-2 text-center h-12 flex items-center justify-center';
                        h.textContent = l;
                        cardGrid.appendChild(h);
                    });

                    // Cells
                    for (let row = 0; row < 5; row++) {
                        for (let col = 0; col < 5; col++) {
                            const colKey = COL_KEYS[col];
                            let num = columnPools[colKey][row];
                            const cell = document.createElement('div');
                            cell.className = 'bg-white rounded-lg p-2 text-center h-12 flex items-center justify-center bingo-cell';
                            cell.dataset.row = row;
                            cell.dataset.col = col;
                            cell.dataset.colKey = colKey;

                            if (includeFreeSpace && row === 2 && col === 2) {
                                cell.innerHTML = '<i class="fas fa-star text-blue-600"></i>';
                                cell.classList.add('bg-blue-200');
                            } else {
                                cell.textContent = num;
                                // Add color coding based on number range
                                cell.classList.add(getNumberClass(num));

                                if (calledNumbers.includes(num)) {
                                    cell.classList.add('called');
                                }
                            }

                            // Pattern logic
                            if (selectedPattern === "x") {
                                if (row === col || row + col === 4) cell.classList.add('pattern-x');
                            } else if (selectedPattern === "four-corners") {
                                if ((row === 0 && col === 0) || (row === 0 && col === 4) ||
                                    (row === 4 && col === 0) || (row === 4 && col === 4)) {
                                    cell.classList.add('pattern-four-corners');
                                }
                            } else if (selectedPattern === "blackout") {
                                cell.classList.add('pattern-blackout');
                            } else if (selectedPattern === "line") {
                                if (row === 0 || col === 2) cell.classList.add('pattern-line');
                            } else if (selectedPattern === "hallow") {
                                if (row === 0 || row === 4 || col === 0 || col === 4) {
                                    cell.classList.add('pattern-hallow');
                                }
                            }

                            // Add click functionality to mark numbers
                            cell.addEventListener('click', function() {
                                if (isEditMode) {
                                    // In edit mode, allow editing the number
                                    editCellNumber(this);
                                } else {
                                    // Toggle marked state
                                    this.classList.toggle('marked');

                                    // If marked, remove the original color classes
                                    if (this.classList.contains('marked')) {
                                        this.classList.remove('number-b', 'number-i', 'number-n', 'number-g', 'number-o', 'called');
                                    } else {
                                        // If unmarked, restore the original color class
                                        this.classList.add(getNumberClass(num));
                                        if (calledNumbers.includes(num)) {
                                            this.classList.add('called');
                                        }
                                    }
                                }
                            });

                            cardGrid.appendChild(cell);
                        }
                    }

                    cardDiv.appendChild(cardTitle);
                    cardDiv.appendChild(cardGrid);

                    // Add probability indicator based on strategy
                    const probabilityIndicator = document.createElement('div');
                    if (selectedGenerationStrategy === 'high-frequency') {
                        probabilityIndicator.className = 'probability-indicator high-probability';
                        probabilityIndicator.textContent = 'High Winning Probability';
                    } else if (selectedGenerationStrategy === 'medium-frequency') {
                        probabilityIndicator.className = 'probability-indicator medium-probability';
                        probabilityIndicator.textContent = 'Medium Winning Probability';
                    } else if (selectedGenerationStrategy === 'low-frequency') {
                        probabilityIndicator.className = 'probability-indicator low-probability';
                        probabilityIndicator.textContent = 'Low Winning Probability';
                    } else {
                        probabilityIndicator.className = 'probability-indicator medium-probability';
                        probabilityIndicator.textContent = 'Balanced Winning Probability';
                    }
                    cardDiv.appendChild(probabilityIndicator);

                    // Add winning pattern indicator
                    if (selectedPattern !== 'none') {
                        const patternIndicator = document.createElement('div');
                        patternIndicator.className = 'winning-pattern';
                        patternIndicator.textContent = `Winning Pattern: ${selectedPattern}`;
                        cardDiv.appendChild(patternIndicator);
                    }

                    // Add strategy indicator
                    const strategyIndicator = document.createElement('div');
                    strategyIndicator.className = 'text-xs text-center mt-2 text-gray-600';
                    strategyIndicator.textContent = `Strategy: ${selectedGenerationStrategy.replace('-', ' ')}`;
                    cardDiv.appendChild(strategyIndicator);

                    cardsContainer.appendChild(cardDiv);
                }

                // Show the cards section and hide the placeholder
                cardsSection.style.display = 'block';
                cardsPlaceholder.style.display = 'none';
                cardsGenerated = true;
            }

            function toggleEditMode() {
                isEditMode = !isEditMode;

                if (isEditMode) {
                    // Enter edit mode
                    editBtn.innerHTML = '<i class="fas fa-save mr-2"></i> Save Changes';
                    editBtn.classList.remove('bg-purple-600');
                    editBtn.classList.add('bg-green-600');

                    // Add edit mode styling to cards
                    document.querySelectorAll('.card-container').forEach(card => {
                        card.classList.add('edit-mode');
                    });

                    // Show edit instructions
                    showEditInstructions();
                } else {
                    // Exit edit mode
                    editBtn.innerHTML = '<i class="fas fa-edit mr-2"></i> Edit Cards';
                    editBtn.classList.remove('bg-green-600');
                    editBtn.classList.add('bg-purple-600');

                    // Remove edit mode styling
                    document.querySelectorAll('.card-container').forEach(card => {
                        card.classList.remove('edit-mode');
                    });

                    // Remove any active editing
                    document.querySelectorAll('.bingo-cell.editing').forEach(cell => {
                        cell.classList.remove('editing');
                        const input = cell.querySelector('input');
                        if (input) {
                            cell.textContent = input.value || cell.textContent;
                            // Update the color class based on the new number
                            const newNum = parseInt(cell.textContent);
                            if (!isNaN(newNum)) {
                                cell.classList.remove('number-b', 'number-i', 'number-n', 'number-g', 'number-o');
                                cell.classList.add(getNumberClass(newNum));
                            }
                        }
                    });

                    // Hide edit instructions
                    hideEditInstructions();
                }
            }

            function showEditInstructions() {
                const instructions = document.createElement('div');
                instructions.id = 'edit-instructions';
                instructions.className = 'bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-4';
                instructions.innerHTML = `
                <p class="font-bold">Edit Mode Active</p>
                <p>Click on any number to edit it. Press Enter to save or click outside to cancel.</p>
            `;

                cardsSection.insertBefore(instructions, cardsContainer);
            }

            function hideEditInstructions() {
                const instructions = document.getElementById('edit-instructions');
                if (instructions) {
                    instructions.remove();
                }
            }

            function editCellNumber(cell) {
                // Remove editing from any other cells
                document.querySelectorAll('.bingo-cell.editing').forEach(c => {
                    c.classList.remove('editing');
                    const input = c.querySelector('input');
                    if (input) {
                        c.textContent = input.value || c.textContent;
                        // Update the color class based on the new number
                        const newNum = parseInt(c.textContent);
                        if (!isNaN(newNum)) {
                            c.classList.remove('number-b', 'number-i', 'number-n', 'number-g', 'number-o');
                            c.classList.add(getNumberClass(newNum));
                        }
                    }
                });

                // Skip free space cells
                if (cell.innerHTML.includes('fa-star')) {
                    return;
                }

                // Add editing class
                cell.classList.add('editing');

                // Get current value
                const currentValue = cell.textContent;

                // Create input field
                const input = document.createElement('input');
                input.type = 'number';
                input.className = 'edit-input';
                input.value = currentValue;
                input.min = 1;
                input.max = 75;

                // Clear cell and add input
                cell.textContent = '';
                cell.appendChild(input);
                input.focus();
                input.select();

                // Handle input events
                input.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        // Save on Enter
                        cell.textContent = input.value;
                        cell.classList.remove('editing');

                        // Update the color class based on the new number
                        const newNum = parseInt(input.value);
                        if (!isNaN(newNum)) {
                            cell.classList.remove('number-b', 'number-i', 'number-n', 'number-g', 'number-o');
                            cell.classList.add(getNumberClass(newNum));
                        }
                    } else if (e.key === 'Escape') {
                        // Cancel on Escape
                        cell.textContent = currentValue;
                        cell.classList.remove('editing');
                    }
                });

                input.addEventListener('blur', function() {
                    // Save on blur
                    cell.textContent = input.value || currentValue;
                    cell.classList.remove('editing');

                    // Update the color class based on the new number
                    const newNum = parseInt(cell.textContent);
                    if (!isNaN(newNum)) {
                        cell.classList.remove('number-b', 'number-i', 'number-n', 'number-g', 'number-o');
                        cell.classList.add(getNumberClass(newNum));
                    }
                });
            }

            function downloadCards() {
                if (!cardsGenerated) {
                    alert('Please generate cards first!');
                    return;
                }

                // Create a canvas to render all cards
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const cards = document.querySelectorAll('.bingo-card');

                if (cards.length === 0) {
                    alert('Please generate cards first!');
                    return;
                }

                // For a real implementation, you would need to render each card to the canvas
                // and then convert to PDF or image. For now, we'll just show an alert.
                alert('Download functionality would save all cards as a PDF in a real implementation.');

                // In a real implementation, you would use a library like jsPDF
                // to create a PDF document with all the cards
            }

            // Initially hide the cards section
            cardsSection.style.display = 'none';
            // Initialize percentage previews
            updatePercentagePreviews();
        });
    </script>
</body>

</html>
    
